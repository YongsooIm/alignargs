<!DOCTYPE html>
<html lang="en">

<head>
  <title>Align arguments</title>
  <script src="./alignArgs/implement/AlignArgs.js"></script>
  <script src="./alignArgs/implement/FuncCall.js"></script>
  <script src="./alignArgs/implement/ParseFunc.js"></script>
  <script src="./alignArgs/implement/ParseRefComment.js"></script>

  <link rel="stylesheet" href="./styles.css">
</head>

<body>

  <div id='navbar'>
    <ul>
      <li><a href="./index.html">Align arguments</a></li>
      <li>
        <label for='formatHex' style="word-wrap:break-word" >Format Hex
          <input type='checkbox' id='formatHex' checked/></label>
      </li>
      <li>
        <label for='rightAlignDecimal' style="word-wrap:break-word" >Right align decimal arg
          <input type='checkbox' id='rightAlignDecimal'  checked/></label>
      </li>
      <li>      
        <label style="word-wrap:break-word">Pad type
        <select id="padType" name="padType">
          <option value="space">space</option>
          <option value="tab">tab</option>
        </select>
        </label>  
      </li>
      <li style="float:right"><a href='https://github.com/yongsooim/alignargs/' target='_blank'>Github repo</a></li>
    </ul>
  </div>
  <div id="editor"></div>


  <script src="https://pagecdn.io/lib/ace/1.4.12/ace.js" charset="utf-8"></script>
  <script>


    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/dawn");
    editor.session.setMode("ace/mode/c_cpp");
    editor.setFontSize("18px");
    editor.setShowPrintMargin(false);

    document.getElementById("editor").addEventListener("keypress", debounce);
    document.getElementById("editor").addEventListener("paste", debounce);
    document.getElementById("formatHex").addEventListener("change", debounce);
    document.getElementById("rightAlignDecimal").addEventListener("change", debounce);
    document.getElementById("padType").addEventListener("change", debounce);

    var timeout;

    function debounce(e) {
      if(e.key === 'Enter' || e.type === 'paste' || e.type === 'change'){ 
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          //console.log(currentCursorPosition);

          var currentCursorPosition = editor.getCursorPosition();

          var inputText = editor.getValue();
          var outputText = DoAlign(inputText + "", {
            'rightAlignDecimal': document.getElementById("rightAlignDecimal").checked, 
            'replace' : [], 
            'trimTrail': true, 
            'formatHex': document.getElementById("formatHex").checked,
            'padType': document.getElementById("padType").value
          }) + "";

          editor.setValue(outputText, 1);
          editor.moveCursorTo(currentCursorPosition.row, currentCursorPosition.column, true);

        }, 100);
      }
    }

    </script>
</body>

</html>